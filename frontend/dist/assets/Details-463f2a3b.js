import{c as e,e as j,r as i,j as n,H as k,I as T,B as F,f as z,D,A as Z,g as J,h as Q,i as X,k as Y,C as W,P as ee,m as te,F as O,b as V,u as G,n as se,o as re,R as N,p as ne,s as oe}from"./index-56ac5ff3.js";import{s as $}from"./paragraph.module-b13e4475.js";import{u as H,C as ae}from"./index.esm-3f09c3d2.js";import{T as le}from"./textarea-0b22c7e3.js";import{L as R}from"./label-21f371ba.js";import{S as ie,a as ce}from"./swiper.min-36df36aa.js";import"./index.module-4c8b6b7f.js";const K=({className:o,type:t,children:s,...c})=>e("p",{className:j(o,[{[$.small]:t==="small",[$.medium]:t==="medium",[$.large]:t==="large"}]),children:s});const de=({modelProductId:o,userId:t,...s})=>{const{register:c,control:d,handleSubmit:a,formState:{errors:h},reset:f}=H();i.useState(!1);const[p,l]=i.useState();return n("form",{action:"",className:"space-y-5",onSubmit:a(async u=>{u.modelDeviceId=o;const v=localStorage.getItem("token"),_=u.files,b={...u,files:_[0]};try{const{data:g}=await z.post(D.comment.createComment,{...b},{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+v}})}catch(g){g instanceof Error&&l(g.message)}f()}),children:[e(k,{type:"h1",children:"Оставьте отзыв"}),n("div",{children:[n("div",{className:"sm:flex sm:space-x-5",children:[n("div",{children:[e(R,{htmlFor:"title",children:"Заголовок"}),e(T,{...c("title",{required:{value:!0,message:"Заполните заголовок"}}),placeholder:"title",id:"title"})]}),n("div",{children:[e(R,{htmlFor:"title",children:"Фотография(опционально)"}),e(T,{accept:"image/png, image/jpeg",type:"file",...c("files"),placeholder:"title",id:"title"})]})]}),e(R,{htmlFor:"title",children:"Описание"}),e(le,{...c("comment",{required:{value:!0,message:"Заполните "}}),placeholder:"description"}),e(F,{type:"submit",children:" Оставить комментарий"})]})]})},me=({img:o,className:t})=>n(Z,{children:[e(J,{asChild:!0,children:e("img",{className:t,src:o,alt:""})}),n(Q,{children:[e("img",{className:"w-full h-full",src:o,alt:""}),e(X,{children:e(Y,{children:"Закрыть"})})]})]}),fe=o=>i.createElement("svg",{width:15,height:15,viewBox:"0 0 20 20",fill:"#E2E2E2",xmlns:"http://www.w3.org/2000/svg",...o},i.createElement("path",{d:"M19.9477 7.55686C19.816 7.13427 19.4568 6.83508 19.0335 6.79511L13.2601 6.24816L10.9784 0.673859C10.81 0.264321 10.4267 0 10 0C9.57337 0 9.18991 0.264321 9.02252 0.673859L6.74084 6.24816L0.966519 6.79511C0.543233 6.83587 0.184799 7.13507 0.0523506 7.55686C-0.0793348 7.97946 0.0422796 8.44298 0.362414 8.73596L4.72665 12.7293L3.43985 18.6434C3.34571 19.0782 3.50745 19.5279 3.85322 19.7887C4.03908 19.9296 4.25743 20 4.47655 20C4.66485 20 4.8533 19.9478 5.0216 19.8427L10 16.7364L14.9775 19.8427C15.3427 20.0704 15.8018 20.0495 16.1468 19.7887C16.4926 19.5279 16.6543 19.0782 16.5602 18.6434L15.2734 12.7293L19.6376 8.73596C19.9576 8.44298 20.0794 7.98041 19.9477 7.55686Z"})),ue="_filled_ljj5v_1",he="_star_ljj5v_5",pe="_editable_ljj5v_8",ge="_errorMessage_ljj5v_12",ye="_ratingWrapper_ljj5v_18",ve="_error_ljj5v_12",q={filled:ue,star:he,editable:pe,errorMessage:ge,ratingWrapper:ye,error:ve},we=({rating:o})=>e("div",{children:[1,2,3,4,5].map(s=>e("span",{className:j(q.star,{[q.filled]:s<=o}),children:e(fe,{})}))}),Ce=({userId:o,images:t,comment:s,title:c,model:d,date:a})=>{const[h,f]=i.useState();console.log(t),t&&W(o,t[0],d);const[p,l]=i.useState(!0);i.useEffect(()=>{(async()=>{const g=await(await fetch(D.users.acc+o)).json();if(await new Promise(m=>setTimeout(()=>m(""),1e3)),g)f(g),l(!0);else return})()},[]);const w=d.rating.find(b=>b.writtenById===o);console.log(w);const u=w==null?void 0:w.number;if(!h)return e("div",{});const v=ee(h),_=te(a);return n("div",{className:"p-5 bg-white shadow-md m-2 h-52 rounded-3xl",children:[n("div",{children:[n("div",{className:"flex justify-between",children:[n("div",{className:"flex space-x-4",children:[h.avatar?e("img",{src:v,height:30,className:"rounded-full object-contain w-16 h-16",alt:"avatar"}):e("img",{src:"icon",className:"rounded-full",alt:"avatar"}),n("div",{children:[e(k,{type:"h3",children:h.login}),n("div",{className:"flex space-x-2 my-2s",children:[u&&e(we,{rating:u}),e(k,{type:"h3",children:u})]})]})]}),e("span",{className:"text-gray-200",children:_})]}),n("div",{className:"mt-2",children:[e(k,{type:"h2",children:c}),e(K,{className:"ml-2",type:"medium",children:s})]})]}),t.length>0?t.map(b=>{const g=W(o,b,d);console.log(g);const m=g.split("/");return m[m.length-1]===""?e("div",{}):e(me,{img:g,className:"rounded-md h-16 object-contain"})}):e("div",{})]})};const xe="_filled_ljj5v_1",be="_star_ljj5v_5",Se="_editable_ljj5v_8",_e="_errorMessage_ljj5v_12",Ne="_ratingWrapper_ljj5v_18",je="_error_ljj5v_12",L={filled:xe,star:be,editable:Se,errorMessage:_e,ratingWrapper:Ne,error:je},ke=o=>i.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"#E2E2E2",xmlns:"http://www.w3.org/2000/svg",...o},i.createElement("path",{d:"M19.9477 7.55686C19.816 7.13427 19.4568 6.83508 19.0335 6.79511L13.2601 6.24816L10.9784 0.673859C10.81 0.264321 10.4267 0 10 0C9.57337 0 9.18991 0.264321 9.02252 0.673859L6.74084 6.24816L0.966519 6.79511C0.543233 6.83587 0.184799 7.13507 0.0523506 7.55686C-0.0793348 7.97946 0.0422796 8.44298 0.362414 8.73596L4.72665 12.7293L3.43985 18.6434C3.34571 19.0782 3.50745 19.5279 3.85322 19.7887C4.03908 19.9296 4.25743 20 4.47655 20C4.66485 20 4.8533 19.9478 5.0216 19.8427L10 16.7364L14.9775 19.8427C15.3427 20.0704 15.8018 20.0495 16.1468 19.7887C16.4926 19.5279 16.6543 19.0782 16.5602 18.6434L15.2734 12.7293L19.6376 8.73596C19.9576 8.44298 20.0794 7.98041 19.9477 7.55686Z"})),Ae=i.forwardRef(({className:o,isEditable:t=!1,rating:s,setRating:c,error:d,tabIndex:a,...h},f)=>{const p=i.useRef([]),[l,w]=i.useState(new Array(5).fill(e(O,{}))),u=(m,C)=>t&&(!s&&C==0||m==C+1)?a??0:-1;i.useEffect(()=>{v(s)},[s,a]);const v=m=>{const C=l.map((A,y)=>e("span",{className:j(L.star,{[L.filled]:y<m,[L.editable]:t}),onMouseEnter:()=>b(y+1),onMouseLeave:()=>b(s),onClick:()=>_(y+1),tabIndex:u(s,y),onKeyDown:g,ref:S=>{var P;return(P=p.current)==null?void 0:P.push(S)},role:t?"slider":"","aria-valuenow":s,"aria-valuemax":5,"aria-label":t?"выберите кол-во звезд для оценки":"рейтинг"+s,"aria-valuemin":1,children:e(ke,{})},y));w(C)},_=m=>{!t||!c||c(m)},b=m=>{t&&v(m)},g=m=>{var C;!t||!c||((m.code=="ArrowRight"||m.code=="ArrowUp")&&(s?(m.preventDefault(),c(s<5?s++:5)):c(1),(C=p.current[s])==null||C.focus()),(m.code=="ArrowLeft"||m.code=="ArrowDown")&&(m.preventDefault(),c(s<1?s--:1)))};return n("div",{...h,ref:f,className:j(o,L.ratingWrapper,{[L.error]:d}),children:[l.map((m,C)=>e("span",{children:m},C)),d&&e("span",{className:L.errorMessage,children:d.message})]})}),Pe=({productId:o,...t})=>{const{register:s,control:c,handleSubmit:d,formState:{errors:a}}=H();i.useState(!1);const[h,f]=i.useState(),[p,l]=i.useState();return n("form",{action:"",className:"sm:flex items-center h-fit",onSubmit:d(async u=>{u.productId=o;try{const{data:v}=await z.post(D.rating.setRating,{...u},{headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}});console.log(v)}catch(v){v instanceof Error&&f(v.message)}}),children:[e(ae,{control:c,name:"quantity",render:({field:u})=>e(Ae,{isEditable:!0,...s("quantity",{required:{value:!0,message:"поставьте оценку"}}),rating:Number(u.value),error:a.quantity,setRating:u.onChange,ref:u.ref,tabIndex:p?0:-1})}),e(F,{type:"submit",children:"оставить рейтинг"})]})},Ie="_Black_1h544_1",Le="_CurrentColor_1h544_4",Ee="_Memory_1h544_7",Me="_CurrentPicture_1h544_9",Be="_green_1h544_12",M={Black:Ie,CurrentColor:Le,Memory:Ee,CurrentPicture:Me,green:Be},De=({rating:o})=>{const t=Math.round(o*2)/2,s=24,c=24,d="12,1 15.09,8.09 23,9.36 17,14.64 18.18,22.55 12,18.18 5.82,22.55 7,14.64 1,9.36 8.91,8.09",a=[{offset:"0%",color:"#3b424e"},{offset:"50%",color:"#3b424e"},{offset:"50%",color:"#ffffff"},{offset:"100%",color:"#FFFFFF"}];t<3?a[1].offset=`${t*33.33}%`:t===3?(a[1].offset="33.33%",a[2].offset="33.33%"):t<4?(a[1].offset="33.33%",a[2].offset=`${(t-3)*33.33}%`):t===4?(a[1].offset="33.33%",a[2].offset="66.66%",a[3].offset="66.66%"):(a[1].offset="33.33%",a[2].offset="66.66%",a[3].offset=`${(t-4)*33.33}%`);const h=a.map(f=>e("stop",{offset:f.offset,stopColor:f.color},f.offset));return n("svg",{width:s,height:c,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("defs",{children:e("linearGradient",{id:"starGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:h})}),e("polygon",{points:d,fill:"url(#starGradient)"})]})},Fe=({smartPhone:o,currentModel:t})=>{var I;const[s,c]=i.useState(o);V(r=>r.user.user);let d=(I=s.image)==null?void 0:I.split(",");i.useEffect(()=>{m(d[0])},[s]);const a=localStorage.getItem("token"),h=G(),[f,p]=i.useState(),[l,w]=i.useState();console.log(s.id);const[u,v]=i.useState(),[_,b]=i.useState(),[g,m]=i.useState(d[0]),C=r=>{const x=t.product.find(E=>{if(E.ColorAlias===r)return E});x&&(v(r),b(x.Memory),c(x))},A=r=>{const x=t.product.find(E=>{if(E.Memory===r)return E});x&&(b(r),v(x.ColorAlias),c(x))},y=Math.floor(t.rating.map(r=>r.number).reduce((r,x)=>r+Number(x),0)/t.rating.length),[S,P]=i.useState(!1);return i.useEffect(()=>{(async()=>{if(f){const x=await(await fetch(D.basket.addBasket,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+a},method:"POST",body:JSON.stringify({productId:s.id,quantity:1})})).json();w(x.id)}else if(!l){if(!l)return;h(se({id:l}))}})()},[f]),d.pop(),d=d.map(r=>re(t,s,r)),n(O,{children:[n("div",{className:"mx-auto lg:flex lg:space-x-5 justify-between",children:[e("div",{className:"my-4 lg:my-0 rounded-3xl bg-blue-300 p-2 mx-12 sm:p-10 ",children:d.map(r=>e("img",{className:j(" rounded-3xl object-contain w-16 h-16",{[M.CurrentPicture]:r===g}),src:r,onClick:()=>m(r)},r))}),n("div",{className:"m-auto",children:[d&&e("img",{src:g,width:300,className:"text-center h-auto sm:h-fit w-38 sm:w-42 mx-auto object-contain rounded-3xl",alt:"Phone"}),","]}),n("div",{className:" mx-12 lg:mx-auto lg:w-1/3  md:text-start space-y-8",children:[n("div",{className:"mx-auto flex justify-between",children:[e("h1",{className:"text-4xl font-bold",children:s.name}),n("div",{className:"flex space-x-2s items-center",children:[n(k,{type:"h1",children:[y," "]}),e(De,{rating:y})]})]}),n("h2",{className:"text-lg font-bold",children:[s.price,"₽"]}),n("h2",{className:"text-lg line-through",children:[s.oldPrice,"₽"]}),e("h2",{className:"text-lg font-bold",children:"Описание"}),e(K,{type:"small",className:"break-words sm:mx-0  sm:w-full ",children:s.Description}),n("div",{className:"flex border rounded-3xl p-5 justify-around sm:space-x-24 w-full",children:[n("div",{className:"content-center ",children:[e("h1",{className:"font-bold",children:"Цвета"}),t.product.map(r=>e("div",{onClick:()=>C(r.ColorAlias),className:j(M[r.ColorAlias]+" mx-auto rounded-full w-10 h-10 p-5 hover:opacity-5",{[M.CurrentColor]:u===r.ColorAlias})},r.ColorAlias))]}),n("div",{children:[e("h1",{className:"font-bold",children:"Память"}),t.product.map(r=>e("div",{onClick:()=>A(r.Memory),className:j(M[r.Memory]+"mx-auto rounded-full w-14 h-14 p-3 hover:opacity-5",{[M.CurrentColor]:_===r.Memory}),children:r.Memory},r.Memory))]})]}),f?e(F,{onClick:()=>p(!1),children:"Убрать из корзины"}):e(F,{onClick:()=>p(!0),children:"Добавить в корзину"}),e("h1",{})]})]}),e("div",{className:"sm:flex space-y-5 bg-white rounded-3xl p-10 my-5  justify-between",children:a!==null&&n(O,{children:[e(de,{modelProductId:s.modelDeviceId,userId:"123123"}),e(Pe,{productId:s.modelDeviceId,isOpened:S})]})}),n("div",{children:[n("div",{className:"flex items-center space-x-2",children:[e(k,{type:"h1",children:"Комментарии: "}),e("span",{className:"accent-gray-500 text-2xl font-bold mt-2",children:t.Comment.length})]}),t.Comment?e("div",{className:"my-20 flex  justify-around w-full overflow-hidden",children:e(ie,{className:"flex",spaceBetween:10,slidesPerView:3,direction:"horizontal",breakpoints:{340:{slidesPerView:1},738:{slidesPerView:2},1092:{slidesPerView:3}},centeredSlides:!1,onSlideChange:()=>console.log("slide change"),onSwiper:r=>console.log(r),children:t.Comment.map(r=>{var x;return e(ce,{className:"w-42 mx-10 h-52",children:e(Ce,{model:t,images:(x=r.pictures)==null?void 0:x.split(","),title:r.title,userId:r.writtenById,date:r.createdAt,comment:r.comment},r.id)},r.id)})})}):e(k,{type:"h2",children:"Оставьте свой первый комментарий"})]})]})},$e=N.createContext({}),U=!0;function Re({baseColor:o,highlightColor:t,width:s,height:c,borderRadius:d,circle:a,direction:h,duration:f,enableAnimation:p=U}){const l={};return h==="rtl"&&(l["--animation-direction"]="reverse"),typeof f=="number"&&(l["--animation-duration"]=`${f}s`),p||(l["--pseudo-element-display"]="none"),(typeof s=="string"||typeof s=="number")&&(l.width=s),(typeof c=="string"||typeof c=="number")&&(l.height=c),(typeof d=="string"||typeof d=="number")&&(l.borderRadius=d),a&&(l.borderRadius="50%"),typeof o<"u"&&(l["--base-color"]=o),typeof t<"u"&&(l["--highlight-color"]=t),l}function B({count:o=1,wrapper:t,className:s,containerClassName:c,containerTestId:d,circle:a=!1,style:h,...f}){var p,l,w;const u=N.useContext($e),v={...f};for(const[y,S]of Object.entries(f))typeof S>"u"&&delete v[y];const _={...u,...v,circle:a},b={...h,...Re(_)};let g="react-loading-skeleton";s&&(g+=` ${s}`);const m=(p=_.inline)!==null&&p!==void 0?p:!1,C=[],A=Math.ceil(o);for(let y=0;y<A;y++){let S=b;if(A>o&&y===A-1){const I=(l=S.width)!==null&&l!==void 0?l:"100%",r=o%1,x=typeof I=="number"?I*r:`calc(${I} * ${r})`;S={...S,width:x}}const P=N.createElement("span",{className:g,style:S,key:y},"‌");m?C.push(P):C.push(N.createElement(N.Fragment,{key:y},P,N.createElement("br",null)))}return N.createElement("span",{className:c,"data-testid":d,"aria-live":"polite","aria-busy":(w=_.enableAnimation)!==null&&w!==void 0?w:U},t?C.map((y,S)=>N.createElement(t,{key:S},y)):C)}const Oe=()=>n("div",{className:"hidden sm:flex items-center justify-between",children:[e(B,{width:150,height:600,borderRadius:"2rem"}),e(B,{width:400,height:700,borderRadius:"2rem"}),n("div",{className:"flex flex-col items-center self-start",children:[e(B,{width:300,height:50,borderRadius:"2rem"}),e(B,{width:300,height:50,borderRadius:"2rem"}),e(B,{width:300,height:50,borderRadius:"2rem"})]})]}),Ke=()=>{const{id:o}=ne(),[t,s]=i.useState(),[c,d]=i.useState(!1);i.useState();function a(){history.back()}const h=G();i.useEffect(()=>{(async()=>{const l=await(await fetch(D.product.findByAlias+o)).json();if(await new Promise(w=>setTimeout(()=>w(""),1e3)),l)h(oe(l.modelDevice.id)),s(l),d(!0);else return})()});const f=V(p=>p.phone.currentModel);return n("div",{children:[e("button",{onClick:a,children:"Назад"}),c?t&&e(Fe,{smartPhone:t,currentModel:f}):e(Oe,{})]})};export{Ke as default};
