import{c as e,e as j,r as i,j as o,H as k,I as T,B as $,f as z,D as F,A as Z,g as J,h as Q,i as X,k as Y,C as W,P as ee,m as te,F as O,b as V,u as G,n as se,o as re,R as _,p as ne,a as oe,s as ae}from"./index-cc9cc7a8.js";import{s as M}from"./paragraph.module-b13e4475.js";import{u as H,C as le}from"./index.esm-1be2bc4c.js";import{T as ie}from"./textarea-c612b85e.js";import{L as R}from"./label-d0811d7b.js";import{S as ce,a as de}from"./swiper.min-b7c8b8c7.js";import"./index.module-47600db9.js";const K=({className:n,type:t,children:s,...c})=>e("p",{className:j(n,[{[M.small]:t==="small",[M.medium]:t==="medium",[M.large]:t==="large"}]),children:s});const me=({modelProductId:n,userId:t,...s})=>{const{register:c,control:d,handleSubmit:a,formState:{errors:h},reset:f}=H();i.useState(!1);const[v,l]=i.useState();return o("form",{action:"",className:"space-y-5",onSubmit:a(async u=>{u.modelDeviceId=n;const w=localStorage.getItem("token"),S=u.files,b={...u,files:S[0]};try{const{data:g}=await z.post(F.comment.createComment,{...b},{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+w}})}catch(g){g instanceof Error&&l(g.message)}f()}),children:[e(k,{type:"h1",children:"Оставьте отзыв"}),o("div",{children:[o("div",{className:"sm:flex sm:space-x-5",children:[o("div",{children:[e(R,{htmlFor:"title",children:"Заголовок"}),e(T,{...c("title",{required:{value:!0,message:"Заполните заголовок"}}),placeholder:"title",id:"title"})]}),o("div",{children:[e(R,{htmlFor:"title",children:"Фотография(опционально)"}),e(T,{accept:"image/png, image/jpeg",type:"file",...c("files"),placeholder:"title",id:"title"})]})]}),e(R,{htmlFor:"title",children:"Описание"}),e(ie,{...c("comment",{required:{value:!0,message:"Заполните "}}),placeholder:"description"}),e($,{type:"submit",children:" Оставить комментарий"})]})]})},fe=({img:n,className:t})=>o(Z,{children:[e(J,{asChild:!0,children:e("img",{className:t,src:n,alt:""})}),o(Q,{children:[e("img",{className:"w-full h-full",src:n,alt:""}),e(X,{children:e(Y,{children:"Закрыть"})})]})]}),ue=n=>i.createElement("svg",{width:15,height:15,viewBox:"0 0 20 20",fill:"#E2E2E2",xmlns:"http://www.w3.org/2000/svg",...n},i.createElement("path",{d:"M19.9477 7.55686C19.816 7.13427 19.4568 6.83508 19.0335 6.79511L13.2601 6.24816L10.9784 0.673859C10.81 0.264321 10.4267 0 10 0C9.57337 0 9.18991 0.264321 9.02252 0.673859L6.74084 6.24816L0.966519 6.79511C0.543233 6.83587 0.184799 7.13507 0.0523506 7.55686C-0.0793348 7.97946 0.0422796 8.44298 0.362414 8.73596L4.72665 12.7293L3.43985 18.6434C3.34571 19.0782 3.50745 19.5279 3.85322 19.7887C4.03908 19.9296 4.25743 20 4.47655 20C4.66485 20 4.8533 19.9478 5.0216 19.8427L10 16.7364L14.9775 19.8427C15.3427 20.0704 15.8018 20.0495 16.1468 19.7887C16.4926 19.5279 16.6543 19.0782 16.5602 18.6434L15.2734 12.7293L19.6376 8.73596C19.9576 8.44298 20.0794 7.98041 19.9477 7.55686Z"})),he="_filled_ljj5v_1",pe="_star_ljj5v_5",ge="_editable_ljj5v_8",ye="_errorMessage_ljj5v_12",ve="_ratingWrapper_ljj5v_18",we="_error_ljj5v_12",q={filled:he,star:pe,editable:ge,errorMessage:ye,ratingWrapper:ve,error:we},Ce=({rating:n})=>e("div",{children:[1,2,3,4,5].map(s=>e("span",{className:j(q.star,{[q.filled]:s<=n}),children:e(ue,{})}))}),xe=({userId:n,images:t,comment:s,title:c,model:d,date:a})=>{const[h,f]=i.useState();console.log(t),t&&W(n,t[0],d);const[v,l]=i.useState(!0);i.useEffect(()=>{(async()=>{const g=await(await fetch(F.users.acc+n)).json();if(await new Promise(m=>setTimeout(()=>m(""),1e3)),g)f(g),l(!0);else return;console.log("user123"+n)})()},[]);const p=d.rating.find(b=>b.writtenById===n);console.log(p);const u=p==null?void 0:p.number;if(!h||!h.avatar)return e("div",{});const w=ee(h),S=te(a);return o("div",{className:"p-5 bg-white shadow-md m-2 h-52 rounded-3xl",children:[o("div",{children:[o("div",{className:"flex justify-between",children:[o("div",{className:"flex space-x-4",children:[h.avatar?e("img",{src:w,height:30,className:"rounded-full object-contain w-16 h-16",alt:"avatar"}):e("img",{src:"icon",className:"rounded-full",alt:"avatar"}),o("div",{children:[e(k,{type:"h3",children:h.login}),o("div",{className:"flex space-x-2 my-2s",children:[u&&e(Ce,{rating:u}),e(k,{type:"h3",children:u})]})]})]}),e("span",{className:"text-gray-200",children:S})]}),o("div",{className:"mt-2",children:[e(k,{type:"h2",children:c}),e(K,{className:"ml-2",type:"medium",children:s})]})]}),t.length>0?t.map(b=>{const g=W(n,b,d);console.log(g);const m=g.split("/");return m[m.length-1]===""?e("div",{}):e(fe,{img:g,className:"rounded-md h-16 object-contain"})}):e("div",{})]})};const be="_filled_ljj5v_1",Ne="_star_ljj5v_5",Se="_editable_ljj5v_8",_e="_errorMessage_ljj5v_12",je="_ratingWrapper_ljj5v_18",ke="_error_ljj5v_12",L={filled:be,star:Ne,editable:Se,errorMessage:_e,ratingWrapper:je,error:ke},Ae=n=>i.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"#E2E2E2",xmlns:"http://www.w3.org/2000/svg",...n},i.createElement("path",{d:"M19.9477 7.55686C19.816 7.13427 19.4568 6.83508 19.0335 6.79511L13.2601 6.24816L10.9784 0.673859C10.81 0.264321 10.4267 0 10 0C9.57337 0 9.18991 0.264321 9.02252 0.673859L6.74084 6.24816L0.966519 6.79511C0.543233 6.83587 0.184799 7.13507 0.0523506 7.55686C-0.0793348 7.97946 0.0422796 8.44298 0.362414 8.73596L4.72665 12.7293L3.43985 18.6434C3.34571 19.0782 3.50745 19.5279 3.85322 19.7887C4.03908 19.9296 4.25743 20 4.47655 20C4.66485 20 4.8533 19.9478 5.0216 19.8427L10 16.7364L14.9775 19.8427C15.3427 20.0704 15.8018 20.0495 16.1468 19.7887C16.4926 19.5279 16.6543 19.0782 16.5602 18.6434L15.2734 12.7293L19.6376 8.73596C19.9576 8.44298 20.0794 7.98041 19.9477 7.55686Z"})),Pe=i.forwardRef(({className:n,isEditable:t=!1,rating:s,setRating:c,error:d,tabIndex:a,...h},f)=>{const v=i.useRef([]),[l,p]=i.useState(new Array(5).fill(e(O,{}))),u=(m,C)=>t&&(!s&&C==0||m==C+1)?a??0:-1;i.useEffect(()=>{w(s)},[s,a]);const w=m=>{const C=l.map((A,y)=>e("span",{className:j(L.star,{[L.filled]:y<m,[L.editable]:t}),onMouseEnter:()=>b(y+1),onMouseLeave:()=>b(s),onClick:()=>S(y+1),tabIndex:u(s,y),onKeyDown:g,ref:N=>{var P;return(P=v.current)==null?void 0:P.push(N)},role:t?"slider":"","aria-valuenow":s,"aria-valuemax":5,"aria-label":t?"выберите кол-во звезд для оценки":"рейтинг"+s,"aria-valuemin":1,children:e(Ae,{})},y));p(C)},S=m=>{!t||!c||c(m)},b=m=>{t&&w(m)},g=m=>{var C;!t||!c||((m.code=="ArrowRight"||m.code=="ArrowUp")&&(s?(m.preventDefault(),c(s<5?s++:5)):c(1),(C=v.current[s])==null||C.focus()),(m.code=="ArrowLeft"||m.code=="ArrowDown")&&(m.preventDefault(),c(s<1?s--:1)))};return o("div",{...h,ref:f,className:j(n,L.ratingWrapper,{[L.error]:d}),children:[l.map((m,C)=>e("span",{children:m},C)),d&&e("span",{className:L.errorMessage,children:d.message})]})}),Ie=({productId:n,...t})=>{const{register:s,control:c,handleSubmit:d,formState:{errors:a}}=H();i.useState(!1);const[h,f]=i.useState(),[v,l]=i.useState();return o("form",{action:"",className:"sm:flex items-center h-fit",onSubmit:d(async u=>{u.productId=n;try{const{data:w}=await z.post(F.rating.setRating,{...u},{headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")}});console.log(w)}catch(w){w instanceof Error&&f(w.message)}}),children:[e(le,{control:c,name:"quantity",render:({field:u})=>e(Pe,{isEditable:!0,...s("quantity",{required:{value:!0,message:"поставьте оценку"}}),rating:Number(u.value),error:a.quantity,setRating:u.onChange,ref:u.ref,tabIndex:v?0:-1})}),e($,{type:"submit",children:"оставить рейтинг"})]})},Le="_Black_1h544_1",Ee="_CurrentColor_1h544_4",Be="_Memory_1h544_7",De="_CurrentPicture_1h544_9",Fe="_green_1h544_12",B={Black:Le,CurrentColor:Ee,Memory:Be,CurrentPicture:De,green:Fe},$e=({rating:n})=>{const t=Math.round(n*2)/2,s=24,c=24,d="12,1 15.09,8.09 23,9.36 17,14.64 18.18,22.55 12,18.18 5.82,22.55 7,14.64 1,9.36 8.91,8.09",a=[{offset:"0%",color:"#3b424e"},{offset:"50%",color:"#3b424e"},{offset:"50%",color:"#ffffff"},{offset:"100%",color:"#FFFFFF"}];t<3?a[1].offset=`${t*33.33}%`:t===3?(a[1].offset="33.33%",a[2].offset="33.33%"):t<4?(a[1].offset="33.33%",a[2].offset=`${(t-3)*33.33}%`):t===4?(a[1].offset="33.33%",a[2].offset="66.66%",a[3].offset="66.66%"):(a[1].offset="33.33%",a[2].offset="66.66%",a[3].offset=`${(t-4)*33.33}%`);const h=a.map(f=>e("stop",{offset:f.offset,stopColor:f.color},f.offset));return o("svg",{width:s,height:c,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("defs",{children:e("linearGradient",{id:"starGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:h})}),e("polygon",{points:d,fill:"url(#starGradient)"})]})},Me=({smartPhone:n,currentModel:t})=>{var I;const[s,c]=i.useState(n);V(r=>r.user.user);let d=(I=s.image)==null?void 0:I.split(",");i.useEffect(()=>{m(d[0])},[s]);const a=localStorage.getItem("token"),h=G(),[f,v]=i.useState(),[l,p]=i.useState();console.log(s.id);const[u,w]=i.useState(),[S,b]=i.useState(),[g,m]=i.useState(d[0]),C=r=>{const x=t.product.find(E=>{if(E.ColorAlias===r)return E});x&&(w(r),b(x.Memory),c(x))},A=r=>{const x=t.product.find(E=>{if(E.Memory===r)return E});x&&(b(r),w(x.ColorAlias),c(x))},y=Math.floor(t.rating.map(r=>r.number).reduce((r,x)=>r+Number(x),0)/t.rating.length),[N,P]=i.useState(!1);return i.useEffect(()=>{(async()=>{if(f){const x=await(await fetch(F.basket.addBasket,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+a},method:"POST",body:JSON.stringify({productId:s.id,quantity:1})})).json();p(x.id)}else if(!l){if(!l)return;h(se({id:l}))}})()},[f]),d.pop(),d=d.map(r=>re(t,s,r)),o(O,{children:[o("div",{className:"mx-auto lg:flex lg:space-x-5 justify-between",children:[e("div",{className:"my-4 lg:my-0 rounded-3xl bg-blue-300 p-2 mx-12 sm:p-10 ",children:d.map(r=>e("img",{className:j(" rounded-3xl object-contain w-16 h-16",{[B.CurrentPicture]:r===g}),src:r,onClick:()=>m(r)},r))}),o("div",{className:"m-auto",children:[d&&e("img",{src:g,width:300,className:"text-center h-auto sm:h-fit w-38 sm:w-42 mx-auto object-contain rounded-3xl",alt:"Phone"}),","]}),o("div",{className:" mx-12 lg:mx-auto lg:w-1/3  md:text-start space-y-8",children:[o("div",{className:"mx-auto flex justify-between",children:[e("h1",{className:"text-4xl font-bold",children:s.name}),o("div",{className:"flex space-x-2s items-center",children:[o(k,{type:"h1",children:[y," "]}),e($e,{rating:y})]})]}),o("h2",{className:"text-lg font-bold",children:[s.price,"₽"]}),o("h2",{className:"text-lg line-through",children:[s.oldPrice,"₽"]}),e("h2",{className:"text-lg font-bold",children:"Описание"}),e(K,{type:"small",className:"break-words sm:mx-0  sm:w-full ",children:s.Description}),o("div",{className:"flex border rounded-3xl p-5 justify-around sm:space-x-24 w-full",children:[o("div",{className:"content-center ",children:[e("h1",{className:"font-bold",children:"Цвета"}),t.product.map(r=>e("div",{onClick:()=>C(r.ColorAlias),className:j(B[r.ColorAlias]+" mx-auto rounded-full w-10 h-10 p-5 hover:opacity-5",{[B.CurrentColor]:u===r.ColorAlias})},r.ColorAlias))]}),o("div",{children:[e("h1",{className:"font-bold",children:"Память"}),t.product.map(r=>e("div",{onClick:()=>A(r.Memory),className:j(B[r.Memory]+"mx-auto rounded-full w-14 h-14 p-3 hover:opacity-5",{[B.CurrentColor]:S===r.Memory}),children:r.Memory},r.Memory))]})]}),f?e($,{onClick:()=>v(!1),children:"Убрать из корзины"}):e($,{onClick:()=>v(!0),children:"Добавить в корзину"}),e("h1",{})]})]}),e("div",{className:"sm:flex space-y-5 bg-white rounded-3xl p-10 my-5  justify-between",children:a!==null&&o(O,{children:[e(me,{modelProductId:s.modelDeviceId,userId:"123123"}),e(Ie,{productId:s.modelDeviceId,isOpened:N})]})}),o("div",{children:[o("div",{className:"flex items-center space-x-2",children:[e(k,{type:"h1",children:"Комментарии: "}),e("span",{className:"accent-gray-500 text-2xl font-bold mt-2",children:t.Comment.length})]}),t!=null&&t.Comment?e("div",{className:"my-20 flex  justify-around w-full overflow-hidden",children:e(ce,{className:"flex",spaceBetween:10,slidesPerView:3,direction:"horizontal",breakpoints:{340:{slidesPerView:1},738:{slidesPerView:2},1092:{slidesPerView:3}},centeredSlides:!1,onSlideChange:()=>console.log("slide change"),onSwiper:r=>console.log(r),children:t==null?void 0:t.Comment.map(r=>{var x;return e(de,{className:"w-42 mx-10 h-52",children:e(xe,{model:t,images:(x=r.pictures)==null?void 0:x.split(","),title:r.title,userId:r.writtenById,date:r.createdAt,comment:r.comment},r.id)},r.id)})})}):e(k,{type:"h2",children:"Оставьте свой первый комментарий"})]})]})},Re=_.createContext({}),U=!0;function Oe({baseColor:n,highlightColor:t,width:s,height:c,borderRadius:d,circle:a,direction:h,duration:f,enableAnimation:v=U}){const l={};return h==="rtl"&&(l["--animation-direction"]="reverse"),typeof f=="number"&&(l["--animation-duration"]=`${f}s`),v||(l["--pseudo-element-display"]="none"),(typeof s=="string"||typeof s=="number")&&(l.width=s),(typeof c=="string"||typeof c=="number")&&(l.height=c),(typeof d=="string"||typeof d=="number")&&(l.borderRadius=d),a&&(l.borderRadius="50%"),typeof n<"u"&&(l["--base-color"]=n),typeof t<"u"&&(l["--highlight-color"]=t),l}function D({count:n=1,wrapper:t,className:s,containerClassName:c,containerTestId:d,circle:a=!1,style:h,...f}){var v,l,p;const u=_.useContext(Re),w={...f};for(const[y,N]of Object.entries(f))typeof N>"u"&&delete w[y];const S={...u,...w,circle:a},b={...h,...Oe(S)};let g="react-loading-skeleton";s&&(g+=` ${s}`);const m=(v=S.inline)!==null&&v!==void 0?v:!1,C=[],A=Math.ceil(n);for(let y=0;y<A;y++){let N=b;if(A>n&&y===A-1){const I=(l=N.width)!==null&&l!==void 0?l:"100%",r=n%1,x=typeof I=="number"?I*r:`calc(${I} * ${r})`;N={...N,width:x}}const P=_.createElement("span",{className:g,style:N,key:y},"‌");m?C.push(P):C.push(_.createElement(_.Fragment,{key:y},P,_.createElement("br",null)))}return _.createElement("span",{className:c,"data-testid":d,"aria-live":"polite","aria-busy":(p=S.enableAnimation)!==null&&p!==void 0?p:U},t?C.map((y,N)=>_.createElement(t,{key:N},y)):C)}const Te=()=>o("div",{className:"hidden sm:flex items-center justify-between",children:[e(D,{width:150,height:600,borderRadius:"2rem"}),e(D,{width:400,height:700,borderRadius:"2rem"}),o("div",{className:"flex flex-col items-center self-start",children:[e(D,{width:300,height:50,borderRadius:"2rem"}),e(D,{width:300,height:50,borderRadius:"2rem"}),e(D,{width:300,height:50,borderRadius:"2rem"})]})]}),Ue=()=>{const{id:n}=ne(),[t,s]=i.useState(),[c,d]=i.useState(!1);i.useState();const a=oe();function h(){a(-3)}const f=G();i.useEffect(()=>{(async()=>{const p=await(await fetch(F.product.findByAlias+n)).json();if(await new Promise(u=>setTimeout(()=>u(""),1e3)),p)f(ae(p.modelDevice.id)),s(p),d(!0);else return})()});const v=V(l=>l.phone.currentModel);return o("div",{children:[e("button",{onClick:h,children:"Назад"}),c?t&&e(Me,{smartPhone:t,currentModel:v}):e(Te,{})]})};export{Ue as default};
